{"ast":null,"code":"var _jsxFileName = \"/home/wkd/neruoWar/frontend/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { API_URL, SOCKET_URL } from './config';\nimport io from 'socket.io-client';\nimport './App.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  var _selectedNode$resourc, _selectedNode$resourc2, _selectedNode$resourc3;\n  const [user, setUser] = useState(null);\n  const [nodes, setNodes] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [messageInput, setMessageInput] = useState('');\n  const [socket, setSocket] = useState(null);\n  const [loginForm, setLoginForm] = useState({\n    username: '',\n    password: ''\n  });\n  const [registerForm, setRegisterForm] = useState({\n    username: '',\n    password: '',\n    email: ''\n  });\n  const [isRegistering, setIsRegistering] = useState(false);\n  const [nodeCreationPending, setNodeCreationPending] = useState(false);\n  const [pendingNodeAssociations, setPendingNodeAssociations] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [matchedNodes, setMatchedNodes] = useState([]);\n  const [showCreateNodeModal, setShowCreateNodeModal] = useState(false);\n  const [newNodeData, setNewNodeData] = useState({\n    name: '',\n    description: '',\n    selectedNodeId: null\n  });\n  const [pendingApprovals, setPendingApprovals] = useState([]);\n  const canvasRef = useRef(null);\n  const messagesEndRef = useRef(null);\n\n  // 初始化 Socket 连接\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      const newSocket = io(SOCKET_URL, {\n        auth: {\n          token\n        }\n      });\n      setSocket(newSocket);\n      newSocket.on('connect', () => {\n        console.log('Socket 连接成功');\n      });\n      newSocket.on('disconnect', () => {\n        console.log('Socket 断开连接');\n      });\n      return () => newSocket.close();\n    }\n  }, [user]);\n\n  // Socket 事件监听\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('nodeUpdate', updatedNode => {\n      setNodes(prev => prev.map(n => n._id === updatedNode._id ? updatedNode : n));\n    });\n    socket.on('newMessage', message => {\n      setMessages(prev => [...prev, message]);\n    });\n    socket.on('nodeCreated', node => {\n      setNodes(prev => [...prev, node]);\n    });\n    socket.on('nodeAssociationApproved', data => {\n      setNodes(prev => prev.map(n => n._id === data.nodeId ? {\n        ...n,\n        status: 'approved'\n      } : n));\n      setPendingNodeAssociations(prev => prev.filter(a => a.nodeId !== data.nodeId));\n      alert('节点关联已批准！');\n    });\n    socket.on('nodeAssociationRejected', data => {\n      setNodes(prev => prev.map(n => n._id === data.nodeId ? {\n        ...n,\n        status: 'rejected'\n      } : n));\n      setPendingNodeAssociations(prev => prev.filter(a => a.nodeId !== data.nodeId));\n      alert('节点关联已被拒绝');\n    });\n    socket.on('pendingNodeCreation', data => {\n      if (user && user.role === 'admin') {\n        setPendingApprovals(prev => [...prev, data]);\n      }\n    });\n    return () => {\n      socket.off('nodeUpdate');\n      socket.off('newMessage');\n      socket.off('nodeCreated');\n      socket.off('nodeAssociationApproved');\n      socket.off('nodeAssociationRejected');\n      socket.off('pendingNodeCreation');\n    };\n  }, [socket, user]);\n\n  // 自动滚动到最新消息\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n\n  // 加载用户信息\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      fetchUserInfo(token);\n      fetchNodes(token);\n    }\n  }, []);\n\n  // 绘制节点和连接线\n  useEffect(() => {\n    if (!canvasRef.current) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n\n    // 清空画布\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // 绘制连接线\n    nodes.forEach(node => {\n      var _node$childNodes;\n      if (node.parentNode) {\n        const parent = nodes.find(n => n._id === node.parentNode);\n        if (parent) {\n          ctx.beginPath();\n          ctx.moveTo(node.position.x, node.position.y);\n          ctx.lineTo(parent.position.x, parent.position.y);\n          ctx.strokeStyle = '#666';\n          ctx.lineWidth = 2;\n          ctx.stroke();\n        }\n      }\n      (_node$childNodes = node.childNodes) === null || _node$childNodes === void 0 ? void 0 : _node$childNodes.forEach(childId => {\n        const child = nodes.find(n => n._id === childId);\n        if (child) {\n          ctx.beginPath();\n          ctx.moveTo(node.position.x, node.position.y);\n          ctx.lineTo(child.position.x, child.position.y);\n          ctx.strokeStyle = '#999';\n          ctx.lineWidth = 1;\n          ctx.setLineDash([5, 5]);\n          ctx.stroke();\n          ctx.setLineDash([]);\n        }\n      });\n    });\n\n    // 绘制节点\n    nodes.forEach(node => {\n      const isSelected = (selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode._id) === node._id;\n      const radius = 30;\n\n      // 节点圆圈\n      ctx.beginPath();\n      ctx.arc(node.position.x, node.position.y, radius, 0, 2 * Math.PI);\n\n      // 根据节点状态设置颜色\n      if (node.status === 'pending') {\n        ctx.fillStyle = '#FFA500';\n      } else if (node.status === 'rejected') {\n        ctx.fillStyle = '#FF0000';\n      } else if (isSelected) {\n        ctx.fillStyle = '#4CAF50';\n      } else {\n        ctx.fillStyle = '#2196F3';\n      }\n      ctx.fill();\n      ctx.strokeStyle = isSelected ? '#FFD700' : '#fff';\n      ctx.lineWidth = isSelected ? 4 : 2;\n      ctx.stroke();\n\n      // 节点名称\n      ctx.fillStyle = '#fff';\n      ctx.font = 'bold 12px Arial';\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n      ctx.fillText(node.name.substring(0, 8), node.position.x, node.position.y);\n\n      // 繁荣度指示器\n      const prosperityHeight = node.prosperity / 500 * 40;\n      ctx.fillStyle = 'rgba(76, 175, 80, 0.5)';\n      ctx.fillRect(node.position.x - radius - 5, node.position.y + radius - prosperityHeight, 5, prosperityHeight);\n    });\n  }, [nodes, selectedNode]);\n  const fetchUserInfo = async token => {\n    try {\n      const response = await fetch(`${API_URL}/auth/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const userData = await response.json();\n        setUser(userData);\n      } else {\n        localStorage.removeItem('token');\n      }\n    } catch (error) {\n      console.error('获取用户信息失败:', error);\n    }\n  };\n  const fetchNodes = async token => {\n    try {\n      const response = await fetch(`${API_URL}/game/nodes`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const nodesData = await response.json();\n        setNodes(nodesData);\n      }\n    } catch (error) {\n      console.error('获取节点失败:', error);\n    }\n  };\n  const handleLogin = async e => {\n    e.preventDefault();\n    try {\n      const response = await fetch(`${API_URL}/auth/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(loginForm)\n      });\n      if (response.ok) {\n        const data = await response.json();\n        localStorage.setItem('token', data.token);\n        setUser(data.user);\n        fetchNodes(data.token);\n\n        // 重新初始化 socket\n        const newSocket = io(SOCKET_URL, {\n          auth: {\n            token: data.token\n          }\n        });\n        setSocket(newSocket);\n      } else {\n        const error = await response.json();\n        alert('登录失败: ' + error.error);\n      }\n    } catch (error) {\n      alert('登录失败: ' + error.message);\n    }\n  };\n  const handleRegister = async e => {\n    e.preventDefault();\n    try {\n      const response = await fetch(`${API_URL}/auth/register`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(registerForm)\n      });\n      if (response.ok) {\n        alert('注册成功！请登录');\n        setIsRegistering(false);\n        setRegisterForm({\n          username: '',\n          password: '',\n          email: ''\n        });\n      } else {\n        const error = await response.json();\n        alert('注册失败: ' + error.error);\n      }\n    } catch (error) {\n      alert('注册失败: ' + error.message);\n    }\n  };\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    setUser(null);\n    setNodes([]);\n    setMessages([]);\n    setSelectedNode(null);\n    if (socket) {\n      socket.close();\n      setSocket(null);\n    }\n  };\n  const handleCanvasClick = e => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    const clickedNode = nodes.find(node => {\n      const distance = Math.sqrt(Math.pow(x - node.position.x, 2) + Math.pow(y - node.position.y, 2));\n      return distance <= 30;\n    });\n    if (clickedNode) {\n      setSelectedNode(clickedNode);\n      fetchNodeMessages(clickedNode._id);\n    } else {\n      setSelectedNode(null);\n    }\n  };\n  const fetchNodeMessages = async nodeId => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch(`${API_URL}/game/nodes/${nodeId}/messages`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const messagesData = await response.json();\n        setMessages(messagesData);\n      }\n    } catch (error) {\n      console.error('获取消息失败:', error);\n    }\n  };\n  const handleSendMessage = e => {\n    e.preventDefault();\n    if (!messageInput.trim() || !selectedNode || !socket) return;\n    socket.emit('sendMessage', {\n      nodeId: selectedNode._id,\n      content: messageInput\n    });\n    setMessageInput('');\n  };\n  const handleSearchNodes = () => {\n    const matched = nodes.filter(node => {\n      var _node$description;\n      return (node.name.toLowerCase().includes(searchQuery.toLowerCase()) || ((_node$description = node.description) === null || _node$description === void 0 ? void 0 : _node$description.toLowerCase().includes(searchQuery.toLowerCase()))) && node.status === 'approved' && node.owner !== (user === null || user === void 0 ? void 0 : user._id);\n    });\n    setMatchedNodes(matched);\n  };\n  const handleOpenCreateNodeModal = () => {\n    setShowCreateNodeModal(true);\n    setNewNodeData({\n      name: '',\n      description: '',\n      selectedNodeId: null\n    });\n    setSearchQuery('');\n    setMatchedNodes([]);\n  };\n  const handleCreateNode = async () => {\n    if (!newNodeData.name || !newNodeData.description) {\n      alert('请填写节点名称和简介');\n      return;\n    }\n    if (user.role !== 'admin' && !newNodeData.selectedNodeId) {\n      alert('普通用户必须选择一个节点进行关联');\n      return;\n    }\n    try {\n      setNodeCreationPending(true);\n      const x = Math.random() * 700 + 50;\n      const y = Math.random() * 400 + 50;\n      socket.emit('createNode', {\n        name: newNodeData.name,\n        description: newNodeData.description,\n        position: {\n          x,\n          y\n        },\n        relatedNodeId: newNodeData.selectedNodeId\n      });\n      if (user.role === 'admin') {\n        alert('节点创建成功！');\n        setShowCreateNodeModal(false);\n      } else {\n        alert('节点创建申请已提交，等待管理员审核');\n        setPendingNodeAssociations(prev => [...prev, {\n          nodeId: newNodeData.selectedNodeId,\n          nodeName: newNodeData.name\n        }]);\n        setShowCreateNodeModal(false);\n      }\n    } catch (error) {\n      alert('创建节点失败: ' + error.message);\n    } finally {\n      setNodeCreationPending(false);\n    }\n  };\n  const handleApproveAssociation = async (pendingData, isParent) => {\n    try {\n      socket.emit('approveNodeAssociation', {\n        pendingNodeId: pendingData.pendingNodeId,\n        relatedNodeId: pendingData.relatedNodeId,\n        isParent: isParent\n      });\n      setPendingApprovals(prev => prev.filter(p => p.pendingNodeId !== pendingData.pendingNodeId));\n      alert('节点关联已批准');\n    } catch (error) {\n      alert('批准失败: ' + error.message);\n    }\n  };\n  const handleRejectAssociation = async pendingData => {\n    try {\n      socket.emit('rejectNodeAssociation', {\n        pendingNodeId: pendingData.pendingNodeId\n      });\n      setPendingApprovals(prev => prev.filter(p => p.pendingNodeId !== pendingData.pendingNodeId));\n      alert('节点关联已拒绝');\n    } catch (error) {\n      alert('拒绝失败: ' + error.message);\n    }\n  };\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"login-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\u8282\\u70B9\\u7BA1\\u7406\\u7CFB\\u7EDF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this), !isRegistering ? /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleLogin,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u767B\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"\\u7528\\u6237\\u540D\",\n            value: loginForm.username,\n            onChange: e => setLoginForm({\n              ...loginForm,\n              username: e.target.value\n            }),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            placeholder: \"\\u5BC6\\u7801\",\n            value: loginForm.password,\n            onChange: e => setLoginForm({\n              ...loginForm,\n              password: e.target.value\n            }),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn btn-primary\",\n            children: \"\\u767B\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"toggle-form\",\n            children: [\"\\u8FD8\\u6CA1\\u6709\\u8D26\\u53F7\\uFF1F\", /*#__PURE__*/_jsxDEV(\"span\", {\n              onClick: () => setIsRegistering(true),\n              children: \"\\u6CE8\\u518C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleRegister,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u6CE8\\u518C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 471,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"\\u7528\\u6237\\u540D\",\n            value: registerForm.username,\n            onChange: e => setRegisterForm({\n              ...registerForm,\n              username: e.target.value\n            }),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            placeholder: \"\\u90AE\\u7BB1\",\n            value: registerForm.email,\n            onChange: e => setRegisterForm({\n              ...registerForm,\n              email: e.target.value\n            }),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            placeholder: \"\\u5BC6\\u7801\",\n            value: registerForm.password,\n            onChange: e => setRegisterForm({\n              ...registerForm,\n              password: e.target.value\n            }),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn btn-success\",\n            children: \"\\u6CE8\\u518C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"toggle-form\",\n            children: [\"\\u5DF2\\u6709\\u8D26\\u53F7\\uFF1F\", /*#__PURE__*/_jsxDEV(\"span\", {\n              onClick: () => setIsRegistering(false),\n              children: \"\\u767B\\u5F55\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 496,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 443,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"game-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"game-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u8282\\u70B9\\u7BA1\\u7406\\u7CFB\\u7EDF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 508,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u6B22\\u8FCE, \", user.username]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 11\n        }, this), user.role === 'admin' && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"admin-badge\",\n          children: \"\\u7BA1\\u7406\\u5458\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 511,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"btn btn-danger\",\n          children: \"\\u9000\\u51FA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 509,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"game-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"left-panel\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"node-canvas-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u8282\\u70B9\\u5730\\u56FE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n            ref: canvasRef,\n            width: 800,\n            height: 500,\n            onClick: handleCanvasClick,\n            className: \"node-canvas\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"controls\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleOpenCreateNodeModal,\n            className: \"btn btn-success\",\n            children: \"\\u521B\\u5EFA\\u65B0\\u8282\\u70B9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"right-panel\",\n        children: [selectedNode ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"node-details\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: selectedNode.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 539,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"node-description\",\n            children: selectedNode.description || '暂无简介'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"node-stats\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"\\u7E41\\u8363\\u5EA6:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 543,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-value\",\n                children: selectedNode.prosperity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 544,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 542,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"\\u98DF\\u7269:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 547,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-value\",\n                children: ((_selectedNode$resourc = selectedNode.resources) === null || _selectedNode$resourc === void 0 ? void 0 : _selectedNode$resourc.food) || 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 548,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 546,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"\\u91D1\\u5C5E:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 551,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-value\",\n                children: ((_selectedNode$resourc2 = selectedNode.resources) === null || _selectedNode$resourc2 === void 0 ? void 0 : _selectedNode$resourc2.metal) || 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 552,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 550,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"\\u80FD\\u91CF:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 555,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-value\",\n                children: ((_selectedNode$resourc3 = selectedNode.resources) === null || _selectedNode$resourc3 === void 0 ? void 0 : _selectedNode$resourc3.energy) || 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 556,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"\\u72B6\\u6001:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 559,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `stat-value status-${selectedNode.status}`,\n                children: selectedNode.status === 'pending' ? '待审核' : selectedNode.status === 'approved' ? '已批准' : '已拒绝'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 560,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 558,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 541,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"\\u8282\\u70B9\\u804A\\u5929\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 568,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"messages-container\",\n              children: [messages.map((msg, index) => {\n                var _msg$sender;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"message\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: [((_msg$sender = msg.sender) === null || _msg$sender === void 0 ? void 0 : _msg$sender.username) || '匿名', \":\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 572,\n                    columnNumber: 23\n                  }, this), \" \", msg.content]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 571,\n                  columnNumber: 21\n                }, this);\n              }), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: messagesEndRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 575,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 569,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleSendMessage,\n              className: \"message-form\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: messageInput,\n                onChange: e => setMessageInput(e.target.value),\n                placeholder: \"\\u8F93\\u5165\\u6D88\\u606F...\",\n                className: \"message-input\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 578,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"btn btn-primary\",\n                children: \"\\u53D1\\u9001\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 585,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 577,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 538,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"no-selection\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u70B9\\u51FB\\u8282\\u70B9\\u67E5\\u770B\\u8BE6\\u60C5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 591,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 13\n        }, this), user.role === 'admin' && pendingApprovals.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pending-approvals\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\u5F85\\u5BA1\\u6838\\u7684\\u8282\\u70B9\\u5173\\u8054\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 15\n          }, this), pendingApprovals.map((pending, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pending-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: pending.nodeName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 601,\n                columnNumber: 21\n              }, this), ' ', \"\\u7533\\u8BF7\\u5173\\u8054\\u5230\", ' ', /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: pending.relatedNodeName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 603,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 600,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"node-description\",\n              children: pending.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 605,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"approval-buttons\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleApproveAssociation(pending, true),\n                className: \"btn btn-success btn-sm\",\n                children: \"\\u6279\\u51C6\\uFF08\\u5B50\\u96C6\\uFF09\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 607,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleApproveAssociation(pending, false),\n                className: \"btn btn-info btn-sm\",\n                children: \"\\u6279\\u51C6\\uFF08\\u6BCD\\u96C6\\uFF09\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 613,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleRejectAssociation(pending),\n                className: \"btn btn-danger btn-sm\",\n                children: \"\\u62D2\\u7EDD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 619,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 606,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 596,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 536,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 7\n    }, this), showCreateNodeModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onClick: () => setShowCreateNodeModal(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\u521B\\u5EFA\\u65B0\\u8282\\u70B9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 636,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u8282\\u70B9\\u540D\\u79F0:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 638,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: newNodeData.name,\n            onChange: e => setNewNodeData({\n              ...newNodeData,\n              name: e.target.value\n            }),\n            placeholder: \"\\u8F93\\u5165\\u8282\\u70B9\\u540D\\u79F0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 639,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 637,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u8282\\u70B9\\u7B80\\u4ECB:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 647,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: newNodeData.description,\n            onChange: e => setNewNodeData({\n              ...newNodeData,\n              description: e.target.value\n            }),\n            placeholder: \"\\u8F93\\u5165\\u8282\\u70B9\\u7B80\\u4ECB\",\n            rows: \"3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 648,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 646,\n          columnNumber: 13\n        }, this), user.role !== 'admin' && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u5173\\u8054\\u8282\\u70B9\\uFF08\\u5FC5\\u586B\\uFF09:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 659,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"search-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                placeholder: \"\\u641C\\u7D22\\u8282\\u70B9\\u540D\\u79F0\\u6216\\u7B80\\u4ECB\",\n                value: searchQuery,\n                onChange: e => setSearchQuery(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 661,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleSearchNodes,\n                className: \"btn btn-primary btn-sm\",\n                children: \"\\u641C\\u7D22\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 667,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 660,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"matched-nodes-container\",\n            children: matchedNodes.map(node => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `node-card ${newNodeData.selectedNodeId === node._id ? 'selected' : ''}`,\n              onClick: () => setNewNodeData({\n                ...newNodeData,\n                selectedNodeId: node._id\n              }),\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: node.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 680,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: node.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 681,\n                columnNumber: 23\n              }, this), newNodeData.selectedNodeId === node._id && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"selected-badge\",\n                children: \"\\u5DF2\\u9009\\u62E9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 683,\n                columnNumber: 25\n              }, this)]\n            }, node._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 675,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 673,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleCreateNode,\n            disabled: nodeCreationPending,\n            className: \"btn btn-success\",\n            children: nodeCreationPending ? '创建中...' : user.role === 'admin' ? '创建节点' : '提交申请'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 692,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowCreateNodeModal(false),\n            className: \"btn btn-secondary\",\n            children: \"\\u53D6\\u6D88\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 699,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 691,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 635,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 634,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 506,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"tmA3KCkBKttFmTqbxAXvtayWlEM=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","API_URL","SOCKET_URL","io","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s","_selectedNode$resourc","_selectedNode$resourc2","_selectedNode$resourc3","user","setUser","nodes","setNodes","messages","setMessages","selectedNode","setSelectedNode","messageInput","setMessageInput","socket","setSocket","loginForm","setLoginForm","username","password","registerForm","setRegisterForm","email","isRegistering","setIsRegistering","nodeCreationPending","setNodeCreationPending","pendingNodeAssociations","setPendingNodeAssociations","searchQuery","setSearchQuery","matchedNodes","setMatchedNodes","showCreateNodeModal","setShowCreateNodeModal","newNodeData","setNewNodeData","name","description","selectedNodeId","pendingApprovals","setPendingApprovals","canvasRef","messagesEndRef","token","localStorage","getItem","newSocket","auth","on","console","log","close","updatedNode","prev","map","n","_id","message","node","data","nodeId","status","filter","a","alert","role","off","_messagesEndRef$curre","current","scrollIntoView","behavior","fetchUserInfo","fetchNodes","canvas","ctx","getContext","clearRect","width","height","forEach","_node$childNodes","parentNode","parent","find","beginPath","moveTo","position","x","y","lineTo","strokeStyle","lineWidth","stroke","childNodes","childId","child","setLineDash","isSelected","radius","arc","Math","PI","fillStyle","fill","font","textAlign","textBaseline","fillText","substring","prosperityHeight","prosperity","fillRect","response","fetch","headers","Authorization","ok","userData","json","removeItem","error","nodesData","handleLogin","e","preventDefault","method","body","JSON","stringify","setItem","handleRegister","handleLogout","handleCanvasClick","rect","getBoundingClientRect","clientX","left","clientY","top","clickedNode","distance","sqrt","pow","fetchNodeMessages","messagesData","handleSendMessage","trim","emit","content","handleSearchNodes","matched","_node$description","toLowerCase","includes","owner","handleOpenCreateNodeModal","handleCreateNode","random","relatedNodeId","nodeName","handleApproveAssociation","pendingData","isParent","pendingNodeId","p","handleRejectAssociation","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","placeholder","value","onChange","target","required","onClick","ref","resources","food","metal","energy","msg","index","_msg$sender","sender","length","pending","relatedNodeName","stopPropagation","rows","disabled","_c","$RefreshReg$"],"sources":["/home/wkd/neruoWar/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { API_URL, SOCKET_URL } from './config';\nimport io from 'socket.io-client';\nimport './App.css';\n\nconst App = () => {\n  const [user, setUser] = useState(null);\n  const [nodes, setNodes] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [messageInput, setMessageInput] = useState('');\n  const [socket, setSocket] = useState(null);\n  const [loginForm, setLoginForm] = useState({ username: '', password: '' });\n  const [registerForm, setRegisterForm] = useState({ username: '', password: '', email: '' });\n  const [isRegistering, setIsRegistering] = useState(false);\n  const [nodeCreationPending, setNodeCreationPending] = useState(false);\n  const [pendingNodeAssociations, setPendingNodeAssociations] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [matchedNodes, setMatchedNodes] = useState([]);\n  const [showCreateNodeModal, setShowCreateNodeModal] = useState(false);\n  const [newNodeData, setNewNodeData] = useState({ name: '', description: '', selectedNodeId: null });\n  const [pendingApprovals, setPendingApprovals] = useState([]);\n  \n  const canvasRef = useRef(null);\n  const messagesEndRef = useRef(null);\n\n  // 初始化 Socket 连接\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      const newSocket = io(SOCKET_URL, {\n        auth: { token }\n      });\n      setSocket(newSocket);\n\n      newSocket.on('connect', () => {\n        console.log('Socket 连接成功');\n      });\n\n      newSocket.on('disconnect', () => {\n        console.log('Socket 断开连接');\n      });\n\n      return () => newSocket.close();\n    }\n  }, [user]);\n\n  // Socket 事件监听\n  useEffect(() => {\n    if (!socket) return;\n\n    socket.on('nodeUpdate', (updatedNode) => {\n      setNodes((prev) =>\n        prev.map((n) => (n._id === updatedNode._id ? updatedNode : n))\n      );\n    });\n\n    socket.on('newMessage', (message) => {\n      setMessages((prev) => [...prev, message]);\n    });\n\n    socket.on('nodeCreated', (node) => {\n      setNodes((prev) => [...prev, node]);\n    });\n\n    socket.on('nodeAssociationApproved', (data) => {\n      setNodes((prev) =>\n        prev.map((n) =>\n          n._id === data.nodeId ? { ...n, status: 'approved' } : n\n        )\n      );\n      setPendingNodeAssociations((prev) =>\n        prev.filter((a) => a.nodeId !== data.nodeId)\n      );\n      alert('节点关联已批准！');\n    });\n\n    socket.on('nodeAssociationRejected', (data) => {\n      setNodes((prev) =>\n        prev.map((n) =>\n          n._id === data.nodeId ? { ...n, status: 'rejected' } : n\n        )\n      );\n      setPendingNodeAssociations((prev) =>\n        prev.filter((a) => a.nodeId !== data.nodeId)\n      );\n      alert('节点关联已被拒绝');\n    });\n\n    socket.on('pendingNodeCreation', (data) => {\n      if (user && user.role === 'admin') {\n        setPendingApprovals((prev) => [...prev, data]);\n      }\n    });\n\n    return () => {\n      socket.off('nodeUpdate');\n      socket.off('newMessage');\n      socket.off('nodeCreated');\n      socket.off('nodeAssociationApproved');\n      socket.off('nodeAssociationRejected');\n      socket.off('pendingNodeCreation');\n    };\n  }, [socket, user]);\n\n  // 自动滚动到最新消息\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  // 加载用户信息\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      fetchUserInfo(token);\n      fetchNodes(token);\n    }\n  }, []);\n\n  // 绘制节点和连接线\n  useEffect(() => {\n    if (!canvasRef.current) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    \n    // 清空画布\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // 绘制连接线\n    nodes.forEach((node) => {\n      if (node.parentNode) {\n        const parent = nodes.find((n) => n._id === node.parentNode);\n        if (parent) {\n          ctx.beginPath();\n          ctx.moveTo(node.position.x, node.position.y);\n          ctx.lineTo(parent.position.x, parent.position.y);\n          ctx.strokeStyle = '#666';\n          ctx.lineWidth = 2;\n          ctx.stroke();\n        }\n      }\n      \n      node.childNodes?.forEach((childId) => {\n        const child = nodes.find((n) => n._id === childId);\n        if (child) {\n          ctx.beginPath();\n          ctx.moveTo(node.position.x, node.position.y);\n          ctx.lineTo(child.position.x, child.position.y);\n          ctx.strokeStyle = '#999';\n          ctx.lineWidth = 1;\n          ctx.setLineDash([5, 5]);\n          ctx.stroke();\n          ctx.setLineDash([]);\n        }\n      });\n    });\n\n    // 绘制节点\n    nodes.forEach((node) => {\n      const isSelected = selectedNode?._id === node._id;\n      const radius = 30;\n\n      // 节点圆圈\n      ctx.beginPath();\n      ctx.arc(node.position.x, node.position.y, radius, 0, 2 * Math.PI);\n      \n      // 根据节点状态设置颜色\n      if (node.status === 'pending') {\n        ctx.fillStyle = '#FFA500';\n      } else if (node.status === 'rejected') {\n        ctx.fillStyle = '#FF0000';\n      } else if (isSelected) {\n        ctx.fillStyle = '#4CAF50';\n      } else {\n        ctx.fillStyle = '#2196F3';\n      }\n      \n      ctx.fill();\n      ctx.strokeStyle = isSelected ? '#FFD700' : '#fff';\n      ctx.lineWidth = isSelected ? 4 : 2;\n      ctx.stroke();\n\n      // 节点名称\n      ctx.fillStyle = '#fff';\n      ctx.font = 'bold 12px Arial';\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n      ctx.fillText(node.name.substring(0, 8), node.position.x, node.position.y);\n\n      // 繁荣度指示器\n      const prosperityHeight = (node.prosperity / 500) * 40;\n      ctx.fillStyle = 'rgba(76, 175, 80, 0.5)';\n      ctx.fillRect(\n        node.position.x - radius - 5,\n        node.position.y + radius - prosperityHeight,\n        5,\n        prosperityHeight\n      );\n    });\n  }, [nodes, selectedNode]);\n\n  const fetchUserInfo = async (token) => {\n    try {\n      const response = await fetch(`${API_URL}/auth/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const userData = await response.json();\n        setUser(userData);\n      } else {\n        localStorage.removeItem('token');\n      }\n    } catch (error) {\n      console.error('获取用户信息失败:', error);\n    }\n  };\n\n  const fetchNodes = async (token) => {\n    try {\n      const response = await fetch(`${API_URL}/game/nodes`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const nodesData = await response.json();\n        setNodes(nodesData);\n      }\n    } catch (error) {\n      console.error('获取节点失败:', error);\n    }\n  };\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    try {\n      const response = await fetch(`${API_URL}/auth/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(loginForm)\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        localStorage.setItem('token', data.token);\n        setUser(data.user);\n        fetchNodes(data.token);\n        \n        // 重新初始化 socket\n        const newSocket = io(SOCKET_URL, {\n          auth: { token: data.token }\n        });\n        setSocket(newSocket);\n      } else {\n        const error = await response.json();\n        alert('登录失败: ' + error.error);\n      }\n    } catch (error) {\n      alert('登录失败: ' + error.message);\n    }\n  };\n\n  const handleRegister = async (e) => {\n    e.preventDefault();\n    try {\n      const response = await fetch(`${API_URL}/auth/register`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(registerForm)\n      });\n      \n      if (response.ok) {\n        alert('注册成功！请登录');\n        setIsRegistering(false);\n        setRegisterForm({ username: '', password: '', email: '' });\n      } else {\n        const error = await response.json();\n        alert('注册失败: ' + error.error);\n      }\n    } catch (error) {\n      alert('注册失败: ' + error.message);\n    }\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    setUser(null);\n    setNodes([]);\n    setMessages([]);\n    setSelectedNode(null);\n    if (socket) {\n      socket.close();\n      setSocket(null);\n    }\n  };\n\n  const handleCanvasClick = (e) => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n\n    const clickedNode = nodes.find((node) => {\n      const distance = Math.sqrt(\n        Math.pow(x - node.position.x, 2) + Math.pow(y - node.position.y, 2)\n      );\n      return distance <= 30;\n    });\n\n    if (clickedNode) {\n      setSelectedNode(clickedNode);\n      fetchNodeMessages(clickedNode._id);\n    } else {\n      setSelectedNode(null);\n    }\n  };\n\n  const fetchNodeMessages = async (nodeId) => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch(`${API_URL}/game/nodes/${nodeId}/messages`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const messagesData = await response.json();\n        setMessages(messagesData);\n      }\n    } catch (error) {\n      console.error('获取消息失败:', error);\n    }\n  };\n\n  const handleSendMessage = (e) => {\n    e.preventDefault();\n    if (!messageInput.trim() || !selectedNode || !socket) return;\n\n    socket.emit('sendMessage', {\n      nodeId: selectedNode._id,\n      content: messageInput\n    });\n\n    setMessageInput('');\n  };\n\n  const handleSearchNodes = () => {\n    const matched = nodes.filter((node) =>\n      (node.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        node.description?.toLowerCase().includes(searchQuery.toLowerCase())) &&\n      node.status === 'approved' &&\n      node.owner !== user?._id\n    );\n    setMatchedNodes(matched);\n  };\n\n  const handleOpenCreateNodeModal = () => {\n    setShowCreateNodeModal(true);\n    setNewNodeData({ name: '', description: '', selectedNodeId: null });\n    setSearchQuery('');\n    setMatchedNodes([]);\n  };\n\n  const handleCreateNode = async () => {\n    if (!newNodeData.name || !newNodeData.description) {\n      alert('请填写节点名称和简介');\n      return;\n    }\n\n    if (user.role !== 'admin' && !newNodeData.selectedNodeId) {\n      alert('普通用户必须选择一个节点进行关联');\n      return;\n    }\n\n    try {\n      setNodeCreationPending(true);\n      const x = Math.random() * 700 + 50;\n      const y = Math.random() * 400 + 50;\n\n      socket.emit('createNode', {\n        name: newNodeData.name,\n        description: newNodeData.description,\n        position: { x, y },\n        relatedNodeId: newNodeData.selectedNodeId\n      });\n\n      if (user.role === 'admin') {\n        alert('节点创建成功！');\n        setShowCreateNodeModal(false);\n      } else {\n        alert('节点创建申请已提交，等待管理员审核');\n        setPendingNodeAssociations((prev) => [...prev, { \n          nodeId: newNodeData.selectedNodeId,\n          nodeName: newNodeData.name \n        }]);\n        setShowCreateNodeModal(false);\n      }\n    } catch (error) {\n      alert('创建节点失败: ' + error.message);\n    } finally {\n      setNodeCreationPending(false);\n    }\n  };\n\n  const handleApproveAssociation = async (pendingData, isParent) => {\n    try {\n      socket.emit('approveNodeAssociation', {\n        pendingNodeId: pendingData.pendingNodeId,\n        relatedNodeId: pendingData.relatedNodeId,\n        isParent: isParent\n      });\n\n      setPendingApprovals((prev) =>\n        prev.filter((p) => p.pendingNodeId !== pendingData.pendingNodeId)\n      );\n\n      alert('节点关联已批准');\n    } catch (error) {\n      alert('批准失败: ' + error.message);\n    }\n  };\n\n  const handleRejectAssociation = async (pendingData) => {\n    try {\n      socket.emit('rejectNodeAssociation', {\n        pendingNodeId: pendingData.pendingNodeId\n      });\n\n      setPendingApprovals((prev) =>\n        prev.filter((p) => p.pendingNodeId !== pendingData.pendingNodeId)\n      );\n\n      alert('节点关联已拒绝');\n    } catch (error) {\n      alert('拒绝失败: ' + error.message);\n    }\n  };\n\n  if (!user) {\n    return (\n      <div className=\"login-container\">\n        <div className=\"login-box\">\n          <h1>节点管理系统</h1>\n          {!isRegistering ? (\n            <form onSubmit={handleLogin}>\n              <h2>登录</h2>\n              <input\n                type=\"text\"\n                placeholder=\"用户名\"\n                value={loginForm.username}\n                onChange={(e) => setLoginForm({ ...loginForm, username: e.target.value })}\n                required\n              />\n              <input\n                type=\"password\"\n                placeholder=\"密码\"\n                value={loginForm.password}\n                onChange={(e) => setLoginForm({ ...loginForm, password: e.target.value })}\n                required\n              />\n              <button type=\"submit\" className=\"btn btn-primary\">登录</button>\n              <p className=\"toggle-form\">\n                还没有账号？\n                <span onClick={() => setIsRegistering(true)}>注册</span>\n              </p>\n            </form>\n          ) : (\n            <form onSubmit={handleRegister}>\n              <h2>注册</h2>\n              <input\n                type=\"text\"\n                placeholder=\"用户名\"\n                value={registerForm.username}\n                onChange={(e) => setRegisterForm({ ...registerForm, username: e.target.value })}\n                required\n              />\n              <input\n                type=\"email\"\n                placeholder=\"邮箱\"\n                value={registerForm.email}\n                onChange={(e) => setRegisterForm({ ...registerForm, email: e.target.value })}\n                required\n              />\n              <input\n                type=\"password\"\n                placeholder=\"密码\"\n                value={registerForm.password}\n                onChange={(e) => setRegisterForm({ ...registerForm, password: e.target.value })}\n                required\n              />\n              <button type=\"submit\" className=\"btn btn-success\">注册</button>\n              <p className=\"toggle-form\">\n                已有账号？\n                <span onClick={() => setIsRegistering(false)}>登录</span>\n              </p>\n            </form>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"game-container\">\n      <header className=\"game-header\">\n        <h1>节点管理系统</h1>\n        <div className=\"user-info\">\n          <span>欢迎, {user.username}</span>\n          {user.role === 'admin' && <span className=\"admin-badge\">管理员</span>}\n          <button onClick={handleLogout} className=\"btn btn-danger\">退出</button>\n        </div>\n      </header>\n\n      <div className=\"game-content\">\n        <div className=\"left-panel\">\n          <div className=\"node-canvas-container\">\n            <h2>节点地图</h2>\n            <canvas\n              ref={canvasRef}\n              width={800}\n              height={500}\n              onClick={handleCanvasClick}\n              className=\"node-canvas\"\n            />\n          </div>\n\n          <div className=\"controls\">\n            <button onClick={handleOpenCreateNodeModal} className=\"btn btn-success\">\n              创建新节点\n            </button>\n          </div>\n        </div>\n\n        <div className=\"right-panel\">\n          {selectedNode ? (\n            <div className=\"node-details\">\n              <h2>{selectedNode.name}</h2>\n              <p className=\"node-description\">{selectedNode.description || '暂无简介'}</p>\n              <div className=\"node-stats\">\n                <div className=\"stat-item\">\n                  <span className=\"stat-label\">繁荣度:</span>\n                  <span className=\"stat-value\">{selectedNode.prosperity}</span>\n                </div>\n                <div className=\"stat-item\">\n                  <span className=\"stat-label\">食物:</span>\n                  <span className=\"stat-value\">{selectedNode.resources?.food || 0}</span>\n                </div>\n                <div className=\"stat-item\">\n                  <span className=\"stat-label\">金属:</span>\n                  <span className=\"stat-value\">{selectedNode.resources?.metal || 0}</span>\n                </div>\n                <div className=\"stat-item\">\n                  <span className=\"stat-label\">能量:</span>\n                  <span className=\"stat-value\">{selectedNode.resources?.energy || 0}</span>\n                </div>\n                <div className=\"stat-item\">\n                  <span className=\"stat-label\">状态:</span>\n                  <span className={`stat-value status-${selectedNode.status}`}>\n                    {selectedNode.status === 'pending' ? '待审核' : \n                     selectedNode.status === 'approved' ? '已批准' : '已拒绝'}\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"chat-section\">\n                <h3>节点聊天</h3>\n                <div className=\"messages-container\">\n                  {messages.map((msg, index) => (\n                    <div key={index} className=\"message\">\n                      <strong>{msg.sender?.username || '匿名'}:</strong> {msg.content}\n                    </div>\n                  ))}\n                  <div ref={messagesEndRef} />\n                </div>\n                <form onSubmit={handleSendMessage} className=\"message-form\">\n                  <input\n                    type=\"text\"\n                    value={messageInput}\n                    onChange={(e) => setMessageInput(e.target.value)}\n                    placeholder=\"输入消息...\"\n                    className=\"message-input\"\n                  />\n                  <button type=\"submit\" className=\"btn btn-primary\">发送</button>\n                </form>\n              </div>\n            </div>\n          ) : (\n            <div className=\"no-selection\">\n              <p>点击节点查看详情</p>\n            </div>\n          )}\n\n          {user.role === 'admin' && pendingApprovals.length > 0 && (\n            <div className=\"pending-approvals\">\n              <h3>待审核的节点关联</h3>\n              {pendingApprovals.map((pending, index) => (\n                <div key={index} className=\"pending-item\">\n                  <p>\n                    <strong>{pending.nodeName}</strong> \n                    {' '}申请关联到{' '}\n                    <strong>{pending.relatedNodeName}</strong>\n                  </p>\n                  <p className=\"node-description\">{pending.description}</p>\n                  <div className=\"approval-buttons\">\n                    <button\n                      onClick={() => handleApproveAssociation(pending, true)}\n                      className=\"btn btn-success btn-sm\"\n                    >\n                      批准（子集）\n                    </button>\n                    <button\n                      onClick={() => handleApproveAssociation(pending, false)}\n  className=\"btn btn-info btn-sm\"\n                    >\n                      批准（母集）\n                    </button>\n                    <button\n                      onClick={() => handleRejectAssociation(pending)}\n                      className=\"btn btn-danger btn-sm\"\n                    >\n                      拒绝\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {showCreateNodeModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowCreateNodeModal(false)}>\n          <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\n            <h2>创建新节点</h2>\n            <div className=\"form-group\">\n              <label>节点名称:</label>\n              <input\n                type=\"text\"\n                value={newNodeData.name}\n                onChange={(e) => setNewNodeData({ ...newNodeData, name: e.target.value })}\n                placeholder=\"输入节点名称\"\n              />\n            </div>\n            <div className=\"form-group\">\n              <label>节点简介:</label>\n              <textarea\n                value={newNodeData.description}\n                onChange={(e) => setNewNodeData({ ...newNodeData, description: e.target.value })}\n                placeholder=\"输入节点简介\"\n                rows=\"3\"\n              />\n            </div>\n\n            {user.role !== 'admin' && (\n              <>\n                <div className=\"form-group\">\n                  <label>关联节点（必填）:</label>\n                  <div className=\"search-container\">\n                    <input\n                      type=\"text\"\n                      placeholder=\"搜索节点名称或简介\"\n                      value={searchQuery}\n                      onChange={(e) => setSearchQuery(e.target.value)}\n                    />\n                    <button onClick={handleSearchNodes} className=\"btn btn-primary btn-sm\">\n                      搜索\n                    </button>\n                  </div>\n                </div>\n\n                <div className=\"matched-nodes-container\">\n                  {matchedNodes.map((node) => (\n                    <div \n                      key={node._id} \n                      className={`node-card ${newNodeData.selectedNodeId === node._id ? 'selected' : ''}`}\n                      onClick={() => setNewNodeData({ ...newNodeData, selectedNodeId: node._id })}\n                    >\n                      <h4>{node.name}</h4>\n                      <p>{node.description}</p>\n                      {newNodeData.selectedNodeId === node._id && (\n                        <span className=\"selected-badge\">已选择</span>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </>\n            )}\n\n            <div className=\"modal-buttons\">\n              <button\n                onClick={handleCreateNode}\n                disabled={nodeCreationPending}\n                className=\"btn btn-success\"\n              >\n                {nodeCreationPending ? '创建中...' : user.role === 'admin' ? '创建节点' : '提交申请'}\n              </button>\n              <button\n                onClick={() => setShowCreateNodeModal(false)}\n                className=\"btn btn-secondary\"\n              >\n                取消\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}